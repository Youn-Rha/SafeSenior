# 01/02 일지
## Legacy
* fall detection 판별하는 AI 모델 연결과, 해당 기능에 따른 3D 모델 및 컬러 레이블 출력 기능 구현이 필요
* cloudPoint와 떨어진 밑에 3D 모델이 출력되는 현상 해결필요
    * 현재는 임의 해결 하였으나, track 기준이 아닌 AI 기준으로 출력에 따른 변경 필요
* AI 모델 적용 전에 좌표계 변환 필요 + 기존 클러스터링 모델 수정 필요
* 오후 5시 제안서 리뷰 예정
* 12/31부로 매일 보고서 제출 방식 -> 문의 필요
* aicoss 보고서 오늘 제출 시도
* 왼쪽 레이블 연결기능 복구
* 시연영상 촬영 필요

## Visualizer Patch note
### AI 모델 연결
* 기존 fall detection 모듈 연결 및 작동 테스트
    * AI 모델 로드 및 평가는 정상 작동 확인
* 자세변경 기능 활성화
    * 얼굴 부분이 제대로 연결되지 않은 문제 확인하여 해결
    * 박스헤드 또한 정상작동 확인
* AI 모델 입력 전 좌표계 변환기능 구현
    * 기존의 구형 좌표계 데이터로 학습된 AI 모델 지원하기 위한 기능
    * 신규 모델에서는 필요 없기에 매크로 상수 통한 on / off 가능

### AI 추론 클러스터의 좌표에 출력
* 기존 tid 매핑의 변경 필요

### AI 추론의 레이블 색 연동
* 기능 연동하였으나 타이머가 정상 작동하지 않아 표시된 색이 원상복구 불가능
* PeopleTracking의 updateGraph에서 state 통합 관리
    * 변화된 레이블 체크하고, 아닌애들은 티켓 감소형식 구현
    * 변화된 레이블은 해당하는 형식으로 티켓 초기화
        * 세팅 티켓보다 작으면 세팅 티켓으로 올리기
* 타이머 대신 ticket 기반 타이밍 구현
    * 기존 구현은 timer로 인한 오버플로우 등의 오류가 의심되는 상황
    * 계속 쌓이는 timer 대신 scheduler와 유사한 ticket 시스템을 구현
    * 낙상 감지 시 큰 ticket을 부여
    * 일반 움직임 감지 시 작은 ticket을 부여
    * 각 updateGraph마다 ticket을 하나씩 감소, 0 이하인 경우 투명한 색으로 변경
    * 매크로로 정리 및 낙상 컬러링은 단발성으로 구현
        * 붉은 색 표시는 연장 불가능한 형태로 구현

### step 함수의 변경
* iteration에서 변수 매칭 오류를 해결
* x,y,z 대신 Range, Azimuth, Elevation으로 매칭하게 변경
    * 기존 AI 모델과 호환성 위함
    * 해당 매칭 필요없는 새로운 AI로 학습이 향후에 필요

### 클러스터링 파이프라인의 자체 문제점 해소
* agg 과정에서 copy 문제
    * shallow copy 대신 hard copy후, column 증가 하는 방식으로 변경
    * x, y, z 사용하는 클러스터링으로의 변경에서 AI 모델과의 호환성 문제 해소 위해 기존의 column값으로 복원
* global cluster의 새로운 번호 매칭에 문제 있는 가능성 존재 테스트
    * 기존 코드를 풀어놓은 형식으로 변경(임시 코드)
* cluster_data()에서 frameNum이 증발하는 문제 발견
* 문제점 디버깅 위한 테스트코드 작성 : cluster_test.py
    * group 문제

### Replay 기능 구현을 위한 기초작업 진행
* Replay 기능 구현을 준비하기 위해 UI 종류와 위치를 실험
    * 적절한 UI 모양과 위치를 찾은 후 기존 UI에 통합하여 확인함
* 후에 시간이 지남에 따라 슬라이드가 움직이고 버튼을 누를 시 재생/정지 시키는 기능 구현 필요

### 기타
* 기능 제어용 매크로 상수를 core.py에 통합
* 사용하지 않는 모듈 import 제거
* 별도 제어 매크로 정리 파일인 macroControl.py에 정리

## 제안서 리뷰
* 배경 색칠 기능
    * view에 연동
* 사람 그래픽을 이미지로 대체

## TODO
* 금요일 산학연 줌 미팅
* 클러스터링 문제 해결
* AI 추론에 사용한 클러스터 중심좌표에 모델 출력하게 변경
* AI 모델 정상화 후, 모델 변경까지 기능 연결
* 다음 리플레이 기능 준비
* 그래픽 관련 숙제 : 배경 색칠과 사람 이미지 사용